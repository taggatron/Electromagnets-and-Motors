<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">
    <title>Electromagnetism & Motor Effect Physics Lab</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- P5.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .canvas-container {
            width: 100%;
            height: 400px;
            border-radius: 0.5rem;
            overflow: hidden;
            position: relative;
            background-color: #f3f4f6;
        }
        canvas {
            display: block;
            width: 100% !important;
            height: 100% !important;
        }
    </style>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-indigo-600 p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold flex items-center gap-2">
                ‚ö° Physics Lab: Electromagnetism
            </h1>
            <nav class="space-x-4">
                <button onclick="switchTab('learn')" class="hover:text-indigo-200 transition font-semibold" id="nav-learn">Learning Mode</button>
                <button onclick="switchTab('assess')" class="bg-white text-indigo-600 px-4 py-1 rounded-full font-semibold hover:bg-indigo-50 transition" id="nav-assess">Challenge Mode</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4 flex-grow">
        
        <!-- LEARNING MODE -->
        <div id="learning-mode" class="space-y-8">
            
            <!-- Section 1: Electric and Magnetic Fields -->
            <section class="bg-slate-800 p-6 rounded-xl shadow-xl">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/3 space-y-4">
                        <h2 class="text-2xl font-bold text-violet-400">1. Magnetic Field around a Wire</h2>
                        <p class="text-slate-300">
                            When current flows through a straight wire, it creates a circular magnetic field around it.
                        </p>
                        <div class="bg-slate-700 p-4 rounded-lg border-l-4 border-violet-500">
                            <h3 class="font-bold mb-2">Right Hand Grip Rule</h3>
                            <p class="text-sm text-slate-300 mb-2">Imagine gripping the wire with your right hand.</p>
                            <ul class="text-sm space-y-2 text-slate-300 mb-3">
                                <li class="flex items-center gap-2">
                                    <span id="grip-thumb-icon" class="text-2xl inline-block transition-transform duration-300" style="transform: scaleX(-1);">üëç</span>
                                    <span><strong>Thumb:</strong> Direction of Current</span>
                                </li>
                                <li class="flex items-center gap-2">
                                    <span class="text-xl">‚úä</span>
                                    <span><strong>Fingers curled:</strong> Direction of Field</span>
                                </li>
                            </ul>
                        </div>
                        <p class="text-xs text-slate-400">Drag the compass to see how the field aligns!</p>
                        <button id="sim0-toggle-current" class="w-full mt-2 bg-violet-600 hover:bg-violet-500 py-2 rounded text-sm font-bold transition">Reverse Current</button>
                    </div>
                    <div class="md:w-2/3 canvas-container relative flex justify-center items-center bg-slate-800" id="canvas0-container">
                        <!-- SVG Background (Vertical Wire + Hand) -->
                        <svg viewBox="0 0 400 300" class="absolute inset-0 w-full h-full opacity-50 pointer-events-none" preserveAspectRatio="xMidYMid meet">
                            <defs>
                                <marker id="arrowhead-med" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
                                    <polygon points="0 0, 6 3, 0 6" fill="#fbbf24" />
                                </marker>
                            </defs>
                            <g transform="translate(200, 150)">
                                <!-- Wire (Vertical) -->
                                <line x1="0" y1="-140" x2="0" y2="140" stroke="#f59e0b" stroke-width="12" stroke-linecap="round"/>
                            </g>
                        </svg>
                        
                        <!-- P5 Canvas Target -->
                        <div id="canvas0" class="absolute inset-0 w-full h-full z-10"></div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Electromagnets -->
            <section class="bg-slate-800 p-6 rounded-xl shadow-xl">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/3 space-y-4">
                        <h2 class="text-2xl font-bold text-indigo-400">2. Electromagnets</h2>
                        <p class="text-slate-300">
                            An electromagnet consists of a coil of wire wrapped around a soft iron core. 
                            When current flows through the wire, a magnetic field is created.
                        </p>
                        <ul class="text-sm list-disc pl-5 text-slate-400 space-y-2">
                            <li><strong>Current:</strong> More current = Stronger field.</li>
                            <li><strong>Turns:</strong> More coils = Stronger field.</li>
                            <li><strong>Core:</strong> Iron core strengthens the field.</li>
                        </ul>
                        <div class="bg-slate-700 p-4 rounded-lg space-y-3">
                            <label class="block text-sm font-semibold">Current (Amps)</label>
                            <input type="range" id="sim1-current" min="0" max="100" value="50" class="w-full accent-indigo-500">
                            <label class="block text-sm font-semibold">Number of Turns</label>
                            <input type="range" id="sim1-turns" min="5" max="20" value="10" class="w-full accent-indigo-500">
                            <button id="sim1-core-toggle" class="w-full mt-2 bg-slate-600 hover:bg-slate-500 py-2 rounded text-sm font-bold transition flex justify-between px-4 items-center">
                                <span>Iron Core</span>
                                <div class="w-10 h-5 bg-slate-800 rounded-full relative transition-colors duration-200" id="core-toggle-bg">
                                    <div class="w-4 h-4 bg-white rounded-full absolute top-0.5 left-0.5 transition-transform duration-200" id="core-toggle-dot"></div>
                                </div>
                            </button>
                        </div>
                    </div>
                    <div class="md:w-2/3 canvas-container" id="canvas1">
                        <!-- P5 Instance 1 goes here -->
                    </div>
                </div>
            </section>

            <!-- Section 3: Motor Effect (Left Hand Rule) -->
            <section class="bg-slate-800 p-6 rounded-xl shadow-xl">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/3 space-y-4">
                        <h2 class="text-2xl font-bold text-emerald-400">3. The Motor Effect</h2>
                        <p class="text-slate-300">
                            When a current-carrying wire is placed in a magnetic field, it experiences a force. 
                            This is the principle behind electric motors.
                        </p>
                        <div class="bg-slate-700 p-4 rounded-lg border-l-4 border-emerald-500">
                            <h3 class="font-bold mb-2">Fleming's Left Hand Rule</h3>
                            <ul class="text-sm space-y-1 text-slate-300 mb-3">
                                <li>üëâ <strong>First Finger:</strong> Field (N to S)</li>
                                <li>üëâ <strong>SeCond Finger:</strong> Current (+ to -)</li>
                                <li>üëâ <strong>ThuMb:</strong> Motion (Force)</li>
                            </ul>
                            <!-- Isometric Hand View -->
                            <div class="bg-slate-800 rounded p-2 flex justify-center">
                                <svg width="150" height="150" viewBox="0 0 200 200" style="overflow: visible;">
                                    <!-- Axes Definition for Context -->
                                    <defs>
                                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8" />
                                        </marker>
                                        <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                                            <feGaussianBlur stdDeviation="2" result="blur" />
                                            <feComposite in="SourceGraphic" in2="blur" operator="over" />
                                        </filter>
                                    </defs>
                                    
                                    <!-- Hand Schematic (Simplified Blocks) -->
                                    <g transform="translate(100, 120)">
                                        <!-- Palm -->
                                        <path d="M-20 -20 L20 -20 L20 20 L-20 20 Z" fill="#e2e8f0" stroke="#475569" stroke-width="2" />
        
                                        <!-- Thumb (Motion/Force) - Up -->
                                        <g class="hover:opacity-80 transition-opacity">
                                            <rect x="-15" y="-80" width="30" height="60" rx="5" fill="#facc15" stroke="#ca8a04" stroke-width="2" />
                                            <text x="0" y="-90" text-anchor="middle" fill="#facc15" font-size="14" font-weight="bold">Motion</text>
                                            <text x="0" y="-50" text-anchor="middle" fill="#713f12" font-size="10" font-weight="bold">Thumb</text>
                                        </g>
        
                                        <!-- First Finger (Field) - Right Isometric -->
                                        <g transform="rotate(10)" class="hover:opacity-80 transition-opacity">
                                            <rect x="20" y="-15" width="80" height="30" rx="5" fill="#f87171" stroke="#b91c1c" stroke-width="2" />
                                            <text x="110" y="5" text-anchor="middle" fill="#f87171" font-size="14" font-weight="bold">Field</text>
                                            <text x="60" y="5" text-anchor="middle" fill="#7f1d1d" font-size="10" font-weight="bold">First</text>
                                        </g>
        
                                        <!-- Second Finger (Current) - Left Isometric (Into page visual) -->
                                        <!-- Represented as sticking "out" towards viewer or distinct angle -->
                                        <g transform="rotate(120) translate(0,0)" class="hover:opacity-80 transition-opacity">
                                             <rect x="20" y="-15" width="70" height="30" rx="5" fill="#60a5fa" stroke="#1d4ed8" stroke-width="2" />
                                             <text x="110" y="5" text-anchor="middle" fill="#60a5fa" font-size="14" font-weight="bold" transform="rotate(-120 110 5)">Current</text>
                                             <text x="55" y="5" text-anchor="middle" fill="#1e3a8a" font-size="10" font-weight="bold" transform="rotate(-180 55 5)">Second</text>
                                        </g>
                                    </g>
                                </svg>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button id="sim2-toggle-current" class="flex-1 bg-emerald-600 hover:bg-emerald-700 py-2 rounded text-sm font-bold transition">Reverse Current</button>
                            <button id="sim2-toggle-field" class="flex-1 bg-blue-600 hover:bg-blue-700 py-2 rounded text-sm font-bold transition">Reverse Field</button>
                        </div>
                    </div>
                    <div class="md:w-2/3 canvas-container" id="canvas2">
                        <!-- P5 Instance 2 goes here -->
                    </div>
                </div>
            </section>

            <!-- Section 4: Generator Effect (Right Hand Rule) -->
            <section class="bg-slate-800 p-6 rounded-xl shadow-xl">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/3 space-y-4">
                        <h2 class="text-2xl font-bold text-amber-400">4. Generator Effect</h2>
                        <p class="text-slate-300">
                            Moving a wire through a magnetic field induces a current. 
                            This is used in generators.
                        </p>
                        <div class="bg-slate-700 p-4 rounded-lg border-l-4 border-amber-500">
                            <h3 class="font-bold mb-2">Fleming's Right Hand Rule</h3>
                            <ul class="text-sm space-y-1 text-slate-300 mb-3">
                                <li>üëâ <strong>Motion (Thumb):</strong> Direction of movement</li>
                                <li>üëâ <strong>Field (First Finger):</strong> N to S</li>
                                <li>üëâ <strong>Current (Second Finger):</strong> Induced Current</li>
                            </ul>
                            <!-- Isometric Hand View (Right Hand) -->
                            <div class="bg-slate-800 rounded p-2 flex justify-center">
                                <svg width="150" height="150" viewBox="0 0 200 200" style="overflow: visible;">
                                    <defs>
                                        <marker id="arrowhead-r" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                            <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8" />
                                        </marker>
                                    </defs>
                                    
                                    <!-- Hand Schematic (Simplified Blocks) -->
                                    <g transform="translate(100, 120) scale(-1, 1)"> <!-- Flipped X for Right Hand approximation -->
                                        <!-- Palm -->
                                        <path d="M-20 -20 L20 -20 L20 20 L-20 20 Z" fill="#e2e8f0" stroke="#475569" stroke-width="2" />
        
                                        <!-- Thumb (Motion) - Up -->
                                        <g class="hover:opacity-80 transition-opacity">
                                            <rect x="-15" y="-80" width="30" height="60" rx="5" fill="#facc15" stroke="#ca8a04" stroke-width="2" />
                                            <text x="0" y="-90" text-anchor="middle" fill="#facc15" font-size="14" font-weight="bold" transform="scale(-1, 1)">Motion</text>
                                            <text x="0" y="-50" text-anchor="middle" fill="#713f12" font-size="10" font-weight="bold" transform="scale(-1, 1)">Thumb</text>
                                        </g>
        
                                        <!-- First Finger (Field) - Right Isometric (So flipped becomes Left) -->
                                        <g transform="rotate(10)" class="hover:opacity-80 transition-opacity">
                                            <rect x="20" y="-15" width="80" height="30" rx="5" fill="#f87171" stroke="#b91c1c" stroke-width="2" />
                                            <text x="110" y="5" text-anchor="middle" fill="#f87171" font-size="14" font-weight="bold" transform="scale(-1, 1) translate(-220, 0)">Field</text>
                                            <text x="60" y="5" text-anchor="middle" fill="#7f1d1d" font-size="10" font-weight="bold" transform="scale(-1, 1) translate(-120, 0)">First</text>
                                        </g>
        
                                        <!-- Second Finger (Induced Current) - Out/Forward -->
                                        <g transform="rotate(120) translate(0,0)" class="hover:opacity-80 transition-opacity">
                                             <rect x="20" y="-15" width="70" height="30" rx="5" fill="#60a5fa" stroke="#1d4ed8" stroke-width="2" />
                                             <text x="110" y="5" text-anchor="middle" fill="#60a5fa" font-size="14" font-weight="bold" transform="rotate(-120 110 5) scale(-1, 1)">Current</text>
                                             <text x="55" y="5" text-anchor="middle" fill="#1e3a8a" font-size="10" font-weight="bold" transform="rotate(-180 55 5) scale(-1, 1)">Second</text>
                                        </g>
                                    </g>
                                </svg>
                            </div>
                        </div>
                        <p class="text-xs text-slate-400">Drag the wire in the simulation to see the induced current!</p>
                    </div>
                    <div class="md:w-2/3 canvas-container" id="canvas3">
                        <!-- P5 Instance 3 goes here -->
                    </div>
                </div>
            </section>
        </div>

        <!-- ASSESSMENT MODE -->
        <div id="assessment-mode" class="hidden max-w-2xl mx-auto">
            <div class="bg-slate-800 rounded-xl shadow-2xl p-8 border border-slate-700 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-500 via-emerald-500 to-amber-500"></div>
                
                <h2 class="text-3xl font-bold mb-6 text-center">Engineering Challenge</h2>
                
                <!-- Game Container -->
                <div id="game-container" class="space-y-6">
                    <!-- Dynamic Content -->
                </div>

                <!-- Score -->
                <div class="mt-8 pt-6 border-t border-slate-700 flex justify-between items-center text-slate-400">
                    <span>Engineering Rank: <span id="rank-badge" class="font-bold text-white">Apprentice</span></span>
                    <span class="text-xl">Score: <span id="score-display" class="font-bold text-emerald-400">0</span>/300</span>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-slate-900 border-t border-slate-800 p-6 text-center text-slate-500 text-sm">
        <p>Interactive Physics Module</p>
    </footer>

    <script src="simulations.js"></script>
    <script src="game.js"></script>
    <script>
        // Simple tab switching logic
        function switchTab(tab) {
            const learn = document.getElementById('learning-mode');
            const assess = document.getElementById('assessment-mode');
            const btnLearn = document.getElementById('nav-learn');
            const btnAssess = document.getElementById('nav-assess');

            if (tab === 'learn') {
                learn.classList.remove('hidden');
                assess.classList.add('hidden');
                btnLearn.classList.add('text-indigo-200'); // active state style approximation
                btnAssess.classList.remove('bg-indigo-600', 'text-white');
                btnAssess.classList.add('bg-white', 'text-indigo-600');
            } else {
                learn.classList.add('hidden');
                assess.classList.remove('hidden');
                initGame(); // Start game when tab opens
                btnLearn.classList.remove('text-indigo-200');
                btnAssess.classList.add('bg-indigo-600', 'text-white');
                btnAssess.classList.remove('bg-white', 'text-indigo-600');
            }
        }
    </script>
</body>
</html>